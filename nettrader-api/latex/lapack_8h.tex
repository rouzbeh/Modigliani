\subsection{lapack.h File Reference}
\label{lapack_8h}\index{lapack.h@{lapack.h}}
{\ttfamily \#include \char`\"{}tnt/fortran.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}tnt/vec.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}tnt/fmat.h\char`\"{}}\par
Include dependency graph for lapack.h:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=400pt]{lapack_8h__incl}
\end{center}
\end{figure}
\subsubsection*{Defines}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{lapack_8h_a78b0396f6cb0dc34b89486a9fa8af01c}{F77\_\-DGESV}~dgesv\_\-
\item 
\#define \hyperlink{lapack_8h_a1a979a68c68c7188390d19b8e3a71e1f}{F77\_\-DGELS}~dgels\_\-
\item 
\#define \hyperlink{lapack_8h_afd28630502925316bb87b8e3edae87cd}{F77\_\-DSYEV}~dsyev\_\-
\item 
\#define \hyperlink{lapack_8h_a03c36d7eed550c5c3f0474561ec6ba0a}{F77\_\-DGEEV}~dgeev\_\-
\end{DoxyCompactItemize}
\subsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{lapack_8h_acc4862b19c7af8acd47ac62197430d61}{F77\_\-DGESV} (\hyperlink{fortran_8h_ab3df84a792bbb23408a136cf4825aeb4}{cfi\_\-} N, \hyperlink{fortran_8h_ab3df84a792bbb23408a136cf4825aeb4}{cfi\_\-} nrhs, \hyperlink{fortran_8h_a4a18500881ce6d14fcd7eb76b43d6d93}{fda\_\-} A, \hyperlink{fortran_8h_ab3df84a792bbb23408a136cf4825aeb4}{cfi\_\-} lda, \hyperlink{fortran_8h_a785e5772faf258eb171df131439a7597}{fia\_\-} ipiv, \hyperlink{fortran_8h_a4a18500881ce6d14fcd7eb76b43d6d93}{fda\_\-} b, \hyperlink{fortran_8h_ab3df84a792bbb23408a136cf4825aeb4}{cfi\_\-} ldb, \hyperlink{fortran_8h_a5fb0f459886dcbd01f485acca3066001}{fi\_\-} info)
\item 
void \hyperlink{lapack_8h_a1accd6639158310f0a2cbf261e9e055b}{F77\_\-DGELS} (\hyperlink{fortran_8h_a58a9b627931857027cf0be46162b2d5f}{cfch\_\-} trans, \hyperlink{fortran_8h_ab3df84a792bbb23408a136cf4825aeb4}{cfi\_\-} M, \hyperlink{fortran_8h_ab3df84a792bbb23408a136cf4825aeb4}{cfi\_\-} N, \hyperlink{fortran_8h_ab3df84a792bbb23408a136cf4825aeb4}{cfi\_\-} nrhs, \hyperlink{fortran_8h_a4a18500881ce6d14fcd7eb76b43d6d93}{fda\_\-} A, \hyperlink{fortran_8h_ab3df84a792bbb23408a136cf4825aeb4}{cfi\_\-} lda, \hyperlink{fortran_8h_a4a18500881ce6d14fcd7eb76b43d6d93}{fda\_\-} B, \hyperlink{fortran_8h_ab3df84a792bbb23408a136cf4825aeb4}{cfi\_\-} ldb, \hyperlink{fortran_8h_a4a18500881ce6d14fcd7eb76b43d6d93}{fda\_\-} work, \hyperlink{fortran_8h_ab3df84a792bbb23408a136cf4825aeb4}{cfi\_\-} lwork, \hyperlink{fortran_8h_a5fb0f459886dcbd01f485acca3066001}{fi\_\-} info)
\item 
void \hyperlink{lapack_8h_a0cba1a61ea1285d402dc74e9f726308e}{F77\_\-DSYEV} (\hyperlink{fortran_8h_a58a9b627931857027cf0be46162b2d5f}{cfch\_\-} jobz, \hyperlink{fortran_8h_a58a9b627931857027cf0be46162b2d5f}{cfch\_\-} uplo, \hyperlink{fortran_8h_ab3df84a792bbb23408a136cf4825aeb4}{cfi\_\-} N, \hyperlink{fortran_8h_a4a18500881ce6d14fcd7eb76b43d6d93}{fda\_\-} A, \hyperlink{fortran_8h_ab3df84a792bbb23408a136cf4825aeb4}{cfi\_\-} lda, \hyperlink{fortran_8h_a4a18500881ce6d14fcd7eb76b43d6d93}{fda\_\-} W, \hyperlink{fortran_8h_a4a18500881ce6d14fcd7eb76b43d6d93}{fda\_\-} work, \hyperlink{fortran_8h_ab3df84a792bbb23408a136cf4825aeb4}{cfi\_\-} lwork, \hyperlink{fortran_8h_a5fb0f459886dcbd01f485acca3066001}{fi\_\-} info)
\item 
void \hyperlink{lapack_8h_a46f1ea821def22af4ed50f7f58c1c4e0}{F77\_\-DGEEV} (\hyperlink{fortran_8h_a58a9b627931857027cf0be46162b2d5f}{cfch\_\-} jobvl, \hyperlink{fortran_8h_a58a9b627931857027cf0be46162b2d5f}{cfch\_\-} jobvr, \hyperlink{fortran_8h_ab3df84a792bbb23408a136cf4825aeb4}{cfi\_\-} N, \hyperlink{fortran_8h_a4a18500881ce6d14fcd7eb76b43d6d93}{fda\_\-} A, \hyperlink{fortran_8h_ab3df84a792bbb23408a136cf4825aeb4}{cfi\_\-} lda, \hyperlink{fortran_8h_a4a18500881ce6d14fcd7eb76b43d6d93}{fda\_\-} wr, \hyperlink{fortran_8h_a4a18500881ce6d14fcd7eb76b43d6d93}{fda\_\-} wi, \hyperlink{fortran_8h_a4a18500881ce6d14fcd7eb76b43d6d93}{fda\_\-} vl, \hyperlink{fortran_8h_ab3df84a792bbb23408a136cf4825aeb4}{cfi\_\-} ldvl, \hyperlink{fortran_8h_a4a18500881ce6d14fcd7eb76b43d6d93}{fda\_\-} vr, \hyperlink{fortran_8h_ab3df84a792bbb23408a136cf4825aeb4}{cfi\_\-} ldvr, \hyperlink{fortran_8h_a4a18500881ce6d14fcd7eb76b43d6d93}{fda\_\-} work, \hyperlink{fortran_8h_ab3df84a792bbb23408a136cf4825aeb4}{cfi\_\-} lwork, \hyperlink{fortran_8h_a5fb0f459886dcbd01f485acca3066001}{fi\_\-} info)
\item 
\hyperlink{class_t_n_t_1_1_vector}{Vector}$<$ double $>$ \hyperlink{lapack_8h_a3b061771d71cdbc7fecab5fd43629e5e}{Lapack\_\-LU\_\-linear\_\-solve} (const \hyperlink{class_t_n_t_1_1_fortran___matrix}{Fortran\_\-Matrix}$<$ double $>$ \&A, const \hyperlink{class_t_n_t_1_1_vector}{Vector}$<$ double $>$ \&b)
\item 
\hyperlink{class_t_n_t_1_1_vector}{Vector}$<$ double $>$ \hyperlink{lapack_8h_aee400c2434cd9ac8536a209a7e61d219}{Lapack\_\-LLS\_\-QR\_\-linear\_\-solve} (const \hyperlink{class_t_n_t_1_1_fortran___matrix}{Fortran\_\-Matrix}$<$ double $>$ \&A, const \hyperlink{class_t_n_t_1_1_vector}{Vector}$<$ double $>$ \&b)
\item 
\hyperlink{class_t_n_t_1_1_vector}{Vector}$<$ double $>$ \hyperlink{lapack_8h_a22d5ca2db81709756ee24e1f7edc2598}{Upper\_\-symmetric\_\-eigenvalue\_\-solve} (const \hyperlink{class_t_n_t_1_1_fortran___matrix}{Fortran\_\-Matrix}$<$ double $>$ \&A)
\item 
int \hyperlink{lapack_8h_acd0564b1329b11a46046b7f92ecdae36}{eigenvalue\_\-solve} (const \hyperlink{class_t_n_t_1_1_fortran___matrix}{Fortran\_\-Matrix}$<$ double $>$ \&A, \hyperlink{class_t_n_t_1_1_vector}{Vector}$<$ double $>$ \&wr, \hyperlink{class_t_n_t_1_1_vector}{Vector}$<$ double $>$ \&wi)
\end{DoxyCompactItemize}


\subsubsection{Define Documentation}
\index{lapack.h@{lapack.h}!F77\_\-DGEEV@{F77\_\-DGEEV}}
\index{F77\_\-DGEEV@{F77\_\-DGEEV}!lapack.h@{lapack.h}}
\paragraph[{F77\_\-DGEEV}]{\setlength{\rightskip}{0pt plus 5cm}\#define F77\_\-DGEEV~dgeev\_\-}\hfill\label{lapack_8h_a03c36d7eed550c5c3f0474561ec6ba0a}


Definition at line 42 of file lapack.h.



Referenced by eigenvalue\_\-solve().

\index{lapack.h@{lapack.h}!F77\_\-DGELS@{F77\_\-DGELS}}
\index{F77\_\-DGELS@{F77\_\-DGELS}!lapack.h@{lapack.h}}
\paragraph[{F77\_\-DGELS}]{\setlength{\rightskip}{0pt plus 5cm}\#define F77\_\-DGELS~dgels\_\-}\hfill\label{lapack_8h_a1a979a68c68c7188390d19b8e3a71e1f}


Definition at line 40 of file lapack.h.



Referenced by Lapack\_\-LLS\_\-QR\_\-linear\_\-solve().

\index{lapack.h@{lapack.h}!F77\_\-DGESV@{F77\_\-DGESV}}
\index{F77\_\-DGESV@{F77\_\-DGESV}!lapack.h@{lapack.h}}
\paragraph[{F77\_\-DGESV}]{\setlength{\rightskip}{0pt plus 5cm}\#define F77\_\-DGESV~dgesv\_\-}\hfill\label{lapack_8h_a78b0396f6cb0dc34b89486a9fa8af01c}


Definition at line 39 of file lapack.h.



Referenced by Lapack\_\-LU\_\-linear\_\-solve().

\index{lapack.h@{lapack.h}!F77\_\-DSYEV@{F77\_\-DSYEV}}
\index{F77\_\-DSYEV@{F77\_\-DSYEV}!lapack.h@{lapack.h}}
\paragraph[{F77\_\-DSYEV}]{\setlength{\rightskip}{0pt plus 5cm}\#define F77\_\-DSYEV~dsyev\_\-}\hfill\label{lapack_8h_afd28630502925316bb87b8e3edae87cd}


Definition at line 41 of file lapack.h.



Referenced by Upper\_\-symmetric\_\-eigenvalue\_\-solve().



\subsubsection{Function Documentation}
\index{lapack.h@{lapack.h}!eigenvalue\_\-solve@{eigenvalue\_\-solve}}
\index{eigenvalue\_\-solve@{eigenvalue\_\-solve}!lapack.h@{lapack.h}}
\paragraph[{eigenvalue\_\-solve}]{\setlength{\rightskip}{0pt plus 5cm}int eigenvalue\_\-solve (
\begin{DoxyParamCaption}
\item[{const {\bf Fortran\_\-Matrix}$<$ double $>$ \&}]{ A, }
\item[{{\bf Vector}$<$ double $>$ \&}]{ wr, }
\item[{{\bf Vector}$<$ double $>$ \&}]{ wi}
\end{DoxyParamCaption}
)}\hfill\label{lapack_8h_acd0564b1329b11a46046b7f92ecdae36}


Definition at line 148 of file lapack.h.



References F77\_\-DGEEV, TNT::Vector$<$ T $>$::newsize(), TNT::Fortran\_\-Matrix$<$ T $>$::num\_\-cols(), and TNT::Fortran\_\-Matrix$<$ T $>$::num\_\-rows().




\begin{DoxyCode}
{
    char jobvl = 'N';
    char jobvr = 'N';

    Fortran_integer N = A.num_rows();


    assert(N == A.num_cols());
    
    if (N<1) return 1;

    Fortran_Matrix<double> vl(1,N);  /* should be NxN ? **** */
    Fortran_Matrix<double> vr(1,N);  
    Fortran_integer one = 1;

    Fortran_integer worksize = 5*N;
    Fortran_integer info = 0;
    Vector<double> work(worksize, 0.0);
    Fortran_Matrix<double> Tmp = A;

    wr.newsize(N);
    wi.newsize(N);

//  void F77_DGEEV(cfch_ jobvl, cfch_ jobvr, cfi_ N, fda_ A, cfi_ lda,
//      fda_ wr, fda_ wi, fda_ vl, cfi_ ldvl, fda_ vr, 
//      cfi_ ldvr, fda_ work, cfi_ lwork, fi_ info);

    F77_DGEEV(&jobvl, &jobvr, &N, &Tmp(1,1), &N, &(wr(1)),
        &(wi(1)), &(vl(1,1)), &one, &(vr(1,1)), &one,
        &(work(1)), &worksize, &info);

    return (info==0 ? 0: 1);
}
\end{DoxyCode}


\index{lapack.h@{lapack.h}!F77\_\-DGEEV@{F77\_\-DGEEV}}
\index{F77\_\-DGEEV@{F77\_\-DGEEV}!lapack.h@{lapack.h}}
\paragraph[{F77\_\-DGEEV}]{\setlength{\rightskip}{0pt plus 5cm}void F77\_\-DGEEV (
\begin{DoxyParamCaption}
\item[{{\bf cfch\_\-}}]{ jobvl, }
\item[{{\bf cfch\_\-}}]{ jobvr, }
\item[{{\bf cfi\_\-}}]{ N, }
\item[{{\bf fda\_\-}}]{ A, }
\item[{{\bf cfi\_\-}}]{ lda, }
\item[{{\bf fda\_\-}}]{ wr, }
\item[{{\bf fda\_\-}}]{ wi, }
\item[{{\bf fda\_\-}}]{ vl, }
\item[{{\bf cfi\_\-}}]{ ldvl, }
\item[{{\bf fda\_\-}}]{ vr, }
\item[{{\bf cfi\_\-}}]{ ldvr, }
\item[{{\bf fda\_\-}}]{ work, }
\item[{{\bf cfi\_\-}}]{ lwork, }
\item[{{\bf fi\_\-}}]{ info}
\end{DoxyParamCaption}
)}\hfill\label{lapack_8h_a46f1ea821def22af4ed50f7f58c1c4e0}
\index{lapack.h@{lapack.h}!F77\_\-DGELS@{F77\_\-DGELS}}
\index{F77\_\-DGELS@{F77\_\-DGELS}!lapack.h@{lapack.h}}
\paragraph[{F77\_\-DGELS}]{\setlength{\rightskip}{0pt plus 5cm}void F77\_\-DGELS (
\begin{DoxyParamCaption}
\item[{{\bf cfch\_\-}}]{ trans, }
\item[{{\bf cfi\_\-}}]{ M, }
\item[{{\bf cfi\_\-}}]{ N, }
\item[{{\bf cfi\_\-}}]{ nrhs, }
\item[{{\bf fda\_\-}}]{ A, }
\item[{{\bf cfi\_\-}}]{ lda, }
\item[{{\bf fda\_\-}}]{ B, }
\item[{{\bf cfi\_\-}}]{ ldb, }
\item[{{\bf fda\_\-}}]{ work, }
\item[{{\bf cfi\_\-}}]{ lwork, }
\item[{{\bf fi\_\-}}]{ info}
\end{DoxyParamCaption}
)}\hfill\label{lapack_8h_a1accd6639158310f0a2cbf261e9e055b}
\index{lapack.h@{lapack.h}!F77\_\-DGESV@{F77\_\-DGESV}}
\index{F77\_\-DGESV@{F77\_\-DGESV}!lapack.h@{lapack.h}}
\paragraph[{F77\_\-DGESV}]{\setlength{\rightskip}{0pt plus 5cm}void F77\_\-DGESV (
\begin{DoxyParamCaption}
\item[{{\bf cfi\_\-}}]{ N, }
\item[{{\bf cfi\_\-}}]{ nrhs, }
\item[{{\bf fda\_\-}}]{ A, }
\item[{{\bf cfi\_\-}}]{ lda, }
\item[{{\bf fia\_\-}}]{ ipiv, }
\item[{{\bf fda\_\-}}]{ b, }
\item[{{\bf cfi\_\-}}]{ ldb, }
\item[{{\bf fi\_\-}}]{ info}
\end{DoxyParamCaption}
)}\hfill\label{lapack_8h_acc4862b19c7af8acd47ac62197430d61}
\index{lapack.h@{lapack.h}!F77\_\-DSYEV@{F77\_\-DSYEV}}
\index{F77\_\-DSYEV@{F77\_\-DSYEV}!lapack.h@{lapack.h}}
\paragraph[{F77\_\-DSYEV}]{\setlength{\rightskip}{0pt plus 5cm}void F77\_\-DSYEV (
\begin{DoxyParamCaption}
\item[{{\bf cfch\_\-}}]{ jobz, }
\item[{{\bf cfch\_\-}}]{ uplo, }
\item[{{\bf cfi\_\-}}]{ N, }
\item[{{\bf fda\_\-}}]{ A, }
\item[{{\bf cfi\_\-}}]{ lda, }
\item[{{\bf fda\_\-}}]{ W, }
\item[{{\bf fda\_\-}}]{ work, }
\item[{{\bf cfi\_\-}}]{ lwork, }
\item[{{\bf fi\_\-}}]{ info}
\end{DoxyParamCaption}
)}\hfill\label{lapack_8h_a0cba1a61ea1285d402dc74e9f726308e}
\index{lapack.h@{lapack.h}!Lapack\_\-LLS\_\-QR\_\-linear\_\-solve@{Lapack\_\-LLS\_\-QR\_\-linear\_\-solve}}
\index{Lapack\_\-LLS\_\-QR\_\-linear\_\-solve@{Lapack\_\-LLS\_\-QR\_\-linear\_\-solve}!lapack.h@{lapack.h}}
\paragraph[{Lapack\_\-LLS\_\-QR\_\-linear\_\-solve}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Vector}$<$double$>$ Lapack\_\-LLS\_\-QR\_\-linear\_\-solve (
\begin{DoxyParamCaption}
\item[{const {\bf Fortran\_\-Matrix}$<$ double $>$ \&}]{ A, }
\item[{const {\bf Vector}$<$ double $>$ \&}]{ b}
\end{DoxyParamCaption}
)}\hfill\label{lapack_8h_aee400c2434cd9ac8536a209a7e61d219}


Definition at line 96 of file lapack.h.



References F77\_\-DGELS, TNT::Fortran\_\-Matrix$<$ T $>$::num\_\-cols(), and TNT::Fortran\_\-Matrix$<$ T $>$::num\_\-rows().




\begin{DoxyCode}
{
    const Fortran_integer one=1;
    Subscript M=A.num_rows();
    Subscript N=A.num_cols();

    Fortran_Matrix<double> Tmp(A);
    Vector<double> x(b);
    Fortran_integer info = 0;

    char transp = 'N';
    Fortran_integer lwork = 5 * (M+N);      // temporary work space
    Vector<double> work(lwork);

    F77_DGELS(&transp, &M, &N, &one, &Tmp(1,1), &M, &x(1), &M,  &work(1),
        &lwork, &info); 

    if (info != 0) return Vector<double>(0);
    else
        return x;
}
\end{DoxyCode}


\index{lapack.h@{lapack.h}!Lapack\_\-LU\_\-linear\_\-solve@{Lapack\_\-LU\_\-linear\_\-solve}}
\index{Lapack\_\-LU\_\-linear\_\-solve@{Lapack\_\-LU\_\-linear\_\-solve}!lapack.h@{lapack.h}}
\paragraph[{Lapack\_\-LU\_\-linear\_\-solve}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Vector}$<$double$>$ Lapack\_\-LU\_\-linear\_\-solve (
\begin{DoxyParamCaption}
\item[{const {\bf Fortran\_\-Matrix}$<$ double $>$ \&}]{ A, }
\item[{const {\bf Vector}$<$ double $>$ \&}]{ b}
\end{DoxyParamCaption}
)}\hfill\label{lapack_8h_a3b061771d71cdbc7fecab5fd43629e5e}


Definition at line 75 of file lapack.h.



References F77\_\-DGESV, TNT::Fortran\_\-Matrix$<$ T $>$::num\_\-cols(), and TNT::Fortran\_\-Matrix$<$ T $>$::num\_\-rows().




\begin{DoxyCode}
{
    const Fortran_integer one=1;
    Subscript M=A.num_rows();
    Subscript N=A.num_cols();

    Fortran_Matrix<double> Tmp(A);
    Vector<double> x(b);
    Vector<Fortran_integer> index(M);
    Fortran_integer info = 0;

    F77_DGESV(&N, &one, &Tmp(1,1), &M, &index(1), &x(1), &M, &info);    

    if (info != 0) return Vector<double>(0);
    else
        return x;
}
\end{DoxyCode}


\index{lapack.h@{lapack.h}!Upper\_\-symmetric\_\-eigenvalue\_\-solve@{Upper\_\-symmetric\_\-eigenvalue\_\-solve}}
\index{Upper\_\-symmetric\_\-eigenvalue\_\-solve@{Upper\_\-symmetric\_\-eigenvalue\_\-solve}!lapack.h@{lapack.h}}
\paragraph[{Upper\_\-symmetric\_\-eigenvalue\_\-solve}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Vector}$<$double$>$ Upper\_\-symmetric\_\-eigenvalue\_\-solve (
\begin{DoxyParamCaption}
\item[{const {\bf Fortran\_\-Matrix}$<$ double $>$ \&}]{ A}
\end{DoxyParamCaption}
)}\hfill\label{lapack_8h_a22d5ca2db81709756ee24e1f7edc2598}


Definition at line 123 of file lapack.h.



References TNT::Vector$<$ T $>$::begin(), TNT::Fortran\_\-Matrix$<$ T $>$::begin(), F77\_\-DSYEV, TNT::Fortran\_\-Matrix$<$ T $>$::num\_\-cols(), and TNT::Fortran\_\-Matrix$<$ T $>$::num\_\-rows().




\begin{DoxyCode}
{
    char jobz = 'N';
    char uplo = 'U';
    Subscript N = A.num_rows();

    assert(N == A.num_cols());

    Vector<double> eigvals(N);
    Fortran_integer worksize = 3*N;
    Fortran_integer info = 0;
    Vector<double> work(worksize);
    Fortran_Matrix<double> Tmp = A;

    F77_DSYEV(&jobz, &uplo, &N, &Tmp(1,1), &N, eigvals.begin(), work.begin(),
        &worksize, &info);

    if (info != 0) return Vector<double>();
    else
        return eigvals;
}
\end{DoxyCode}


